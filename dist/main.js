(()=>{const e=document.querySelector("#log-books-span"),t=document.querySelector("#log-read-span"),o=document.querySelector("#log-not-read-span");let d=0,n=0;const a=document.querySelectorAll(".dropdown-option"),l=document.querySelectorAll(".btn-top-right");let r=!0,c=!0;const s=document.querySelector("#library"),i=document.querySelector("#div-book-form"),u=document.querySelector("#inp-book-read"),m=document.querySelector(".div-form-book-stars"),b=document.querySelectorAll(".form-star "),y=document.querySelector("#btn-add"),g=document.querySelector("#div-rating"),p=document.querySelectorAll(".rating-star"),h=document.querySelector("#rating-submit");let k,v="",f="",C=!1,S=0;const E=[];let L=0;function x(e,t,o,d,n){this.index=e,this.title=t,this.author=o,this.read=d,this.rating=n}function q(){e.textContent=d.toString(),t.textContent=n.toString(),o.textContent=(d-n).toString()}function A(e){const t=e.target.getAttribute("data-delete"),o=document.querySelector(`[data-book='${t}']`),a=document.querySelector("#library");console.log(`gonna delete ${t}`),d-=1,!0===E[Number(t)].read&&(n-=1),q(),a.removeChild(o),delete E[Number(t)]}function $(e){const t=e.index.toString();console.log(`updating single book: ${t}`);const o=document.querySelector(`[data-read='${t}']`),d=document.querySelector(`[data-divStars='${t}']`);if(!1===e.read)o.textContent="(Not Read)",d.textContent="";else{o.textContent="(Read)";for(let t=0;t<e.rating;t+=1){const e=document.createElement("i");e.classList.add("fa"),e.classList.add("fa-star"),e.classList.add("fa-2x"),e.style.color="rgb(143, 104, 54)",d.appendChild(e)}}}let N=1;function w(e){const t=Number(e.target.getAttribute("data-toggle")),o=E[t];console.log("my book: ",o),!0===o.read?(o.read=!1,o.rating=0,$(o),n-=1):(o.read=!0,g.style.visibility="visible",n+=1),console.log("did flip"),q(),console.log("updated ",E),k=E[t],console.log(`changed read  of  ${t} to: ${E[Number(t)].read}`)}function F(e){const t=[...e];t.map((e=>{const o=e;return o.style.color="#d0ada7",o.addEventListener("click",(e=>{S=Number(e.target.getAttribute("data-star")),N=S,t.map((e=>{const t=e;return Number(e.getAttribute("data-star"))<=S?t.style.color="#aa723d":t.style.color="white",t}))})),o}))}h.addEventListener("click",(()=>{g.style.visibility="hidden",k.rating=N,$(k),console.log(E)})),y.addEventListener("click",(()=>{i.style.visibility="visible",i.classList.add("bubble"),m.style.display="block"})),u.addEventListener("click",(()=>{document.forms.myForm.read.checked?m.style.display="block":(m.style.display="none",S=0)})),F(b),F(p),a.forEach((e=>{e.addEventListener("click",(()=>{!function(e){console.log(`ordering books by: ${e}`);let t=E.slice();"title"!==e&&"author"!==e||(t=t.sort(((t,o)=>t[e].localeCompare(o[e]))).slice());let o=0;t.forEach((t=>{if(void 0!==t){console.log(o);const d=document.querySelector(`[data-book='${t.index.toString()}']`);"date"===e?(d.style.order=`${t.index}`,console.log("book index ",t.index)):"rating"===e?d.style.order=""+(5-t.rating):"author"!==e&&"title"!==e||(d.style.order=`${o}`),o+=1}}))}(e.getAttribute("data-drop"))}))})),[...l].map((e=>{const t=e;return e.addEventListener("click",(()=>{const o=e.getAttribute("data-read");console.log("type button: ",o),E.forEach((e=>{if(void 0!==e){const d=document.querySelector(`[data-book='${e.index.toString()}']`);"read"===o?!0===e.read&&(!0===r?(d.style.display="none",t.style.backgroundColor="#e8d6cb",t.style.color="#ad6a6c"):(d.style.display="flex",t.style.backgroundColor="#ad6a6c",t.style.color="#e8d6cb")):!1===e.read&&(!0===c?(d.style.display="none",t.style.backgroundColor="#e8d6cb",t.style.color="#ad6a6c"):(d.style.display="flex",t.style.backgroundColor="#ad6a6c",t.style.color="#e8d6cb"))}})),r=!r,c=!c})),t})),i.addEventListener("submit",(e=>{e.preventDefault(),v=document.forms.myForm.title.value,f=document.forms.myForm.author.value,C=document.forms.myForm.read.checked,console.log(`book: ${v} ${f} ${C}`),i.style.visibility="hidden",i.reset(),i.classList.remove("bubble"),function(){const e=new x(L,v,f,C,S);E.push(e),function(e){const t=e.title,o=e.author,d=e.read,n=e.rating,a=document.createElement("div");a.classList.add("div-book"),a.setAttribute("data-book",L.toString()),a.style.display="flex",a.style.order=`${L.toString()}`,console.log("data-book: ",a.getAttribute("data-book"));const l=document.createElement("div");l.classList.add("div-book-title-author");const r=document.createElement("div"),c=document.createElement("h2");c.classList.add("book-title"),c.textContent=t,r.appendChild(c),l.appendChild(r);const i=document.createElement("div"),u=document.createElement("h2");u.classList.add("book-author"),u.textContent=o,i.appendChild(u),l.appendChild(i);const m=document.createElement("div");m.classList.add("div-book-read-stars");const b=document.createElement("div"),y=document.createElement("h2");y.setAttribute("data-read",L.toString());const g=document.createElement("div");if(g.setAttribute("data-divStars",L.toString()),d){y.textContent="(Read)";for(let e=0;e<n;e+=1){const e=document.createElement("i");e.classList.add("fa"),e.classList.add("fa-star"),e.classList.add("fa-2x"),e.style.color="#aa723d",g.appendChild(e)}}else y.textContent="(Not Read)";b.appendChild(y),m.appendChild(g),m.appendChild(b),m.insertBefore(b,m.firstChild);const p=document.createElement("div");p.classList.add("div-book-btnDelete");const h=document.createElement("button");h.classList.add("book-btnDelete"),h.textContent="X",h.setAttribute("data-delete",L.toString()),h.addEventListener("click",A),p.appendChild(h);const k=document.createElement("div");k.classList.add("div-book-toggle");const v=document.createElement("label");v.classList.add("label-book-toggle-switch");const f=document.createElement("input");f.setAttribute("type","checkbox"),f.checked=!!d;const C=document.createElement("span");C.classList.add("slider"),C.classList.add("round"),C.setAttribute("data-toggle",L.toString()),C.addEventListener("click",w),v.appendChild(f),v.appendChild(C),k.appendChild(v),a.appendChild(l),a.appendChild(m),a.appendChild(p),a.appendChild(k),L+=1,s.appendChild(a)}(e),d+=1,!0===e.read&&(n+=1),q(),console.log(E)}()}))})();